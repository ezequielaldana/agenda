<script>
const NOTIFICACION_OK =1;
const NOTIFICACION_DANGER =2;
const NOTIFICACION_WARNING =3;
function crearTablaContactos()
{
    let tabla = document.getElementById('tablaContactos');
    if(tabla) tabla.remove();
    
     google.script.run
    .withSuccessHandler(crearTablaContactosCorrectamente)
    .withFailureHandler(crearTablaContactosError)
    .obtenerContactos();
  }
    
function crearTablaContactosCorrectamente(obj)
        {   tabla= document.createElement('table');
            tabla.id= 'tablaContactos';

            let tablaHeader = document.createElement('thead');
            let tablabody = document.createElement('tbody');
            
            
            Array.from(obj).forEach((filaActual, i) =>
               {
                    let fila = document.createElement('tr');
                    filaActual.forEach(celdaActual =>
                    {
                        let celda = document.createElement('td');
                        celda.textContent = celdaActual;
                        fila.appendChild(celda);
                    });
                    if (i == 0)
                    {
                      tablaHeader.appendChild(fila);
                      tabla.appendChild(tablaHeader);
                  
                    }
                    else {
                      tablabody.appendChild(fila);
                    }
                    
                });
            //agregamos clases a la cabecera
            tablaHeader.classList.add('table-dark');
            // agregamos cuerpo a la tabla
            tabla.appendChild(tablabody);
            // agregamos clases a la tabla
            tabla.classList.add('table','table-striped','border','border-4','border-dark');
            // agregramos tabla a la pagina
            document.getElementById('divContactos').appendChild(tabla);

        // mostrar notificacion ok
        crearNotificacion(NOTIFICACION_OK, 'Contactos obtenidos correctamente','Todo en orden')
          }
  function crearTablaContactosError()
  {
    //mostrar notificacion error
    crearNotificacion(NOTIFICACION_DANGER, 'Contactos no obtenidos ','ERROR')
  }
  function crearNotificacion(tipo, mensaje, titulo)
 {  // obtener datos
    let mensajeNotificacion = document.getElementById('mensajeNotificacion');
    let tituloNotificacion = document.getElementById('tituloNotificacion');
    let elementNotificacion = document.getElementById('notificacion');
    let iconoNotificacion = document.getElementById('iconoNotificacion');
    let notificacion = bootstrap.Toast.getOrCreateInstance(elementNotificacion);
    // editar la notificacion
    mensajeNotificacion.textContent= mensaje;
    tituloNotificacion.textContent = titulo;

    switch(tipo)
    {
      case NOTIFICACION_OK:
      iconoNotificacion.className='';
      iconoNotificacion.classList.add('bi','bi-check2-square');
      elementNotificacion.style.backgroundColor= getComputedStyle(document.documentElement).getPropertyValue('--color-verde-oscuro');
      break;

      case NOTIFICACION_DANGER:
      iconoNotificacion.className='';
      iconoNotificacion.classList.add('bi','bi-bug');
      elementNotificacion.style.backgroundColor= getComputedStyle(document.documentElement).getPropertyValue('--color-amarillo-oscuro');
      break;

      case NOTIFICACION_WARNING:
      iconoNotificacion.className='';
      iconoNotificacion.classList.add('bi','bi-exclamation-square');
      elementNotificacion.style.backgroundColor= getComputedStyle(document.documentElement).getPropertyValue('--color-rojo-oscuro');
      break;
    }
    // mostrar la notificacion
    notificacion.show();
  }
</script>