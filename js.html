<script>

function crearTablaContactos()
{
  // borrar tabla
  eliminarTabla();
   
    // crear loader
  crearLoaderPuntos('divContactos');

     google.script.run
    .withSuccessHandler(crearTablaContactosCorrectamente)
    .withFailureHandler(crearTablaContactosError)
    .obtenerContactos();
  }
    
function crearTablaContactosCorrectamente(obj)
        {   tabla= document.createElement('table');
            tabla.id= 'tablaContactos'

            let tablaHeader = document.createElement('thead');
            let tablabody = document.createElement('tbody');
            
            
            Array.from(obj).forEach((filaActual, i) =>
               {
                    let fila = document.createElement('tr');
                    filaActual.forEach(celdaActual =>
                    {
                        let celda = document.createElement('td');
                        celda.textContent = celdaActual;
                        fila.appendChild(celda);
                    });
                    if (i == 0)
                    {
                      tablaHeader.appendChild(fila);
                      tabla.appendChild(tablaHeader);
                  
                    }
                    else {
                      tablabody.appendChild(fila);
                    }
                    
                });
            //agregamos clases a la cabecera
            tablaHeader.classList.add('table-dark');
            // agregamos cuerpo a la tabla
            tabla.appendChild(tablabody);
            // agregamos clases a la tabla
            tabla.classList.add('table','table-striped','border','border-4','border-dark');
            // agregramos tabla a la pagina
            document.getElementById('divContactos').appendChild(tabla);

        // mostrar notificacion ok
        crearNotificacionOk('Contactos obtenidos correctamente','Todo en orden')
        // elinimanos loader
        eliminarLoader();
      }
  function crearTablaContactosError()
  {
    //mostrar notificacion error
    crearNotificacionAdvertencia('Contactos no obtenidos ','ERROR')
    eliminarLoader();
  }
function crearNotificacion(mensaje, titulo)
{
  document.getElementById('mensajeNotificacion').textContent = mensaje;
  document.getElementById('tituloNotificacion').textContent = titulo;
  let elementoNotificacion = document.getElementById('notificacion');
  bootstrap.Toast.getOrCreateInstance(elementoNotificacion).show();

}
function crearNotificacionOk(mensaje, titulo)
{
crearNotificacion(mensaje, titulo);
crearIconoNotificacionOk();
crearColorNotificacion('--color-verde-oscuro');
}
function crearNotificacionError(mensaje, titulo)
{
  crearNotificacion(mensaje, titulo);
crearIconoNotificacionError();
crearColorNotificacion('--color-rojo-oscuro'); 
}
function crearNotificacionAdvertencia(mensaje, titulo)
{
  crearNotificacion(mensaje, titulo);
creariconoNotificacionAdvertencia();
crearColorNotificacion('--color-amarillo-oscuro');
}

function crearIconoNotificacionOk()
{
  document.getElementById('iconoNotificacion').className="";
  document.getElementById('iconoNotificacion').classList.add('bi','bi-check2-square');
}
function creariconoNotificacionError()
{
  document.getElementById('iconoNotificacion').className="";
  document.getElementById('iconoNotificacion').classList.add('bi','bi-bug');
}
function creariconoNotificacionAdvertencia()
{
  document.getElementById('iconoNotificacion').className="";
  document.getElementById('iconoNotificacion').classList.add('bi','bi-exclamation-square');
}

function crearColorNotificacion(color)
{
  let elementNotificacion = document.getElementById('notificacion');
  elementNotificacion.style.backgroundColor= getComputedStyle(document.documentElement).getPropertyValue(color);
      
}

function crearLoader(elementoPadre)
 {
  eliminarLoader();
  let loader = document.createElement('div');
  loader.id = 'loader';
  loader.appendChild(document.createElement('div'));
  loader.appendChild(document.createElement('div'));
  loader.appendChild(document.createElement('div'));
  loader.appendChild(document.createElement('div'));
 
  return document.getElementById(elementoPadre).appendChild(loader); 
 }
function crearLoaderPuntos(elementoPadre)
{
  let loader = crearLoader(elementoPadre);
  loader.classList.add('lds-ellipsis');
}
function crearLoaderAnillos(elementoPadre)
{
  let loader = crearLoader(elementoPadre);
  loader.classList.add('lds-ring');
}
 function eliminarLoader()
 {
  let loader = document.getElementById('loader');
  if (loader) loader.remove();
 }
 function eliminarTabla()
 {
  let tabla = document.getElementById('tablaContactos');
  if(tabla) tabla.remove();
    
 }
</script>